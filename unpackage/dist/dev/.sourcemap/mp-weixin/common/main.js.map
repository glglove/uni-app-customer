{"version":3,"sources":["webpack:///F:/git-uni-app/node-customer/App.vue?1b64","webpack:///F:/git-uni-app/node-customer/App.vue?5909","webpack:///F:/git-uni-app/node-customer/App.vue?82ac","webpack:///F:/git-uni-app/node-customer/App.vue?720b","webpack:///F:/git-uni-app/node-customer/App.vue"],"names":["self","onLaunch","console","log","checkNewVersion","chekWeixinLogin","then","res","getAuthorizeStatus","store","dispatch","authorizeState","authorizeAfter_login","AuthorizeStatus_res","onShow","onHide","methods","uni","canIUse","updateManager","getUpdateManager","onCheckForUpdate","hasUpdate","onUpdateReady","showModal","title","content","success","confirm","applyUpdate","cancel","onUpdateFailed","hideLoading","showCancel","Promise","resolve","reject","checkSession","fail","type","cb","fb","_this","showToast","scopeText","getSetting","getNetworkType","networkType","error","code_loginRes","login","code","getUserInfo","lang","userInfo","iv","encryptedData","signature","rawData","params","commApi","getOpenId","statusCode","resData","data","token","customer","id","appCheckLocalStorageToken","res_localStorage","getStorageSync"],"mappings":"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","file":"common/main.js","sourcesContent":["import mod from \"-!../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-1!../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/index.js??ref--10-oneOf-1-2!../../HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../HBuilderX/plugins/uniapp-cli/node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-4!../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-5!../../HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./App.vue?vue&type=style&index=3&lang=less&\"; export default mod; export * from \"-!../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-1!../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/index.js??ref--10-oneOf-1-2!../../HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../HBuilderX/plugins/uniapp-cli/node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-4!../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-5!../../HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./App.vue?vue&type=style&index=3&lang=less&\"","// extracted by mini-css-extract-plugin","var render, staticRenderFns\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./static/style/base.less?vue&type=style&index=0&lang=less&\"\nimport style1 from \"./static/style/icons.less?vue&type=style&index=1&lang=less&\"\nimport style2 from \"./static/style/iconfont.less?vue&type=style&index=2&lang=less&\"\nimport style3 from \"./App.vue?vue&type=style&index=3&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"F:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!module.hot.data) {\n      api.createRecord('85bc7552', component.options)\n    } else {\n      api.reload('85bc7552', component.options)\n    }\n    \n  }\n}\ncomponent.options.__file = \"git-uni-app/node-customer/App.vue\"\nexport default component.exports","import mod from \"-!../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./App.vue?vue&type=script&lang=js&\"","//\n//\n//\n//\n//\n//\n//\n//\n\nimport store from '@/store/index.js'\nimport getEnterType from '@/utils/miniProSceneType'\nimport { getDeviceApi } from '@/utils/deviceApi.js'\nimport commApi  from '@/api/comm.js'\n\nlet self = ''\nexport default {\n\tonLaunch: async function() {\n\t\tself = this\n\t\t// debugger\n\t\tconsole.log('App Launch')\n\t\t// 小程序检查是否有版本更新 采用条件判断来编译\n\n\t\tthis.checkNewVersion()\n\t\tthis.chekWeixinLogin().then(res => {\n\t\t\tconsole.log(\"---打印检查微信是否登录返回的res---------\", res)\n\t\t\tif(res){\n\t\t\t\t// weixin 登录未过期 页面跳转到 find 首页\n\t\t\t\t\n\t\t\t}else {\n\t\t\t\t// weixin登录已经过期  需要 弹出 微信登录的页面\n\t\t\t\t\n\t\t\t}\n\t\t})\n\t\t// 检查 是否微信已授权用户信息\n\t\tlet AuthorizeStatus_res = await this.getAuthorizeStatus(\"scope.userInfo\", async ()=>{\n\t\t\t// 已经授权回调\n\t\t\t// getDeviceApi().reLaunch({\n\t\t\t// \turl: '../../pages/find/find'\n\t\t\t// })\n\t\t\t// store-app 中 存入 用户授权flag\n\t\t\tconsole.log(\"App------onLaunch------检测到用户信息已授权-true----\")\n\t\t\tstore.dispatch(\"setAuthorizeState\", {authorizeState: true})\t\n\t\t\t// 重新登陆\n\t\t\tthis.authorizeAfter_login().then(() => {\n\t\t\t\tconsole.log(\"APP onLaunch 登陆成功\")\n\t\t\t})\n\t\t}, async function() {\n\t\t\t// 未授权回调\n\t\t\tconsole.log(\"App------onLaunch------检测到用户信息未授权--false---\")\n\t\t\t// store-app 中存入 用户未授权状态 flag\n\t\t\tstore.dispatch(\"setAuthorizeState\", {authorizeState: false})\n\t\t})\n\t\t\n\t\tconsole.log(\"---------APP初始化时，onlanch中打印 是否授权--------\", AuthorizeStatus_res)\n\t\t// if( AuthorizeStatus_res ) {\n\t\t// \t// 已授权\n\t\t// \tgetDeviceApi().reLaunch({\n\t\t// \t\turl: '../../pages/find/find'\n\t\t// \t})\n\t\t// \t// store-app 中 存入 用户授权flag\n\t\t// \tthis.$store.dispatch(\"setAuthorizeState\", true)\n\t\t//  }else {\n\t\t// \tthis.$store.dispatch(\"setAuthorizeState\", false)\n\t\t//  }\n\t\t\t \n\t\t// await this.getAuthorizeStatus(\"scope.userInfo\").then(res => {\n\t\t// \tdebugger\n\t\t// \tif( res ) {\n\t\t// \t\t// 已授权\n\t\t// \t\tgetDeviceApi().reLaunch({\n\t\t// \t\t\turl: './find/find'\n\t\t// \t\t})\n\t\t// \t\t// store-app 中 存入 用户授权flag\n\t\t// \t\tthis.$store.dispatch(\"setAuthorizeState\", true)\n\t\t// \t}else {\n\t\t// \t\tthis.$store.dispatch(\"setAuthorizeState\", false)\n\t\t// \t}\n\t\t// })\n\n\t\t\n\n\n\n\n\t},\n\tonShow: function() {\n\t\tconsole.log('App Show')\n\t\t\t\n\t},\n\tonHide: function() {\n\t\tconsole.log('App Hide')\t\n\t},\n\tmethods:{\n\t\t// 检查是否有版本更新\n\t\tcheckNewVersion () {\n\t\t\tconsole.log(\"-------检查小程序是否有新版本-------checkNewVersion----------\")\n\t\t\t// uni.showLoading({\n\t\t\t// \ttitle:'加载中。。'\n\t\t\t// })\n\t\t\t// 用户版本更新\n\t\t\t// debugger\n\t\t\tif (uni.canIUse(\"getUpdateManager\")) {\n\t\t\t  let updateManager = uni.getUpdateManager();\n\t\t\t  updateManager.onCheckForUpdate((res) => {\n\t\t\t\t// 请求完新版本信息的回调\n\t\t\t\tconsole.log(\"---检查小程序是否有新版本---\",res.hasUpdate);\n\t\t\t  })\n\t\t\t  updateManager.onUpdateReady(() => {\n\t\t\t\t// debugger;\n\t\t\t\tuni.showModal({\n\t\t\t\t  title: '更新提示',\n\t\t\t\t  content: '新版本已经准备好，是否重启应用？',\n\t\t\t\t  success: (res) => {\n\t\t\t\t\tif (res.confirm) {\n\t\t\t\t\t  // 新的版本已经下载好，调用 applyUpdate 应用新版本并重启\n\t\t\t\t\t  updateManager.applyUpdate();\n\t\t\t\t\t} else if (res.cancel) {\n\t\t\t\t\t  return false;\n\t\t\t\t\t}\n\t\t\t\t  }\n\t\t\t\t})\n\t\t\t  })\n\t\t\t  updateManager.onUpdateFailed(() => {\n\t\t\t\t// 新的版本下载失败\n\t\t\t\tuni.hideLoading();\n\t\t\t\tuni.showModal({\n\t\t\t\t  title: '升级失败',\n\t\t\t\t  content: '新版本下载失败，请检查网络！',\n\t\t\t\t  showCancel: false\n\t\t\t\t});\n\t\t\t  });\n\t\t\t}  \n\t\t},\t\t\t\t\t\t\n\t\t// 小程序检查是否 用户授权了\n\t\tchekWeixinLogin () {\n\t\t\t// 微信登录状态监测\t\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tgetDeviceApi().checkSession({\n\t\t\t\t\tsuccess() {\n\t\t\t\t\t\tconsole.log('微信登录session_key未过期，ok');\n\t\t\t\t\t\t// session_key 未过期，并且在本生命周期一直有效\n\t\t\t\t\t\tresolve(true)\n\t\t\t\t\t},\n\t\t\t\t\tfail() {\n\t\t\t\t\t\t// 微信登录已过期\n\t\t\t\t\t\t// session_key 已经失效，需要重新执行登录流程\n\t\t\t\t\t\t//this.getDeviceApi().login() // 重新登录\n\t\t\t\t\t\t// uni.toast(\"微信登录已过期,请重新授权登陆!\")\n\t\t\t\t\t\treject(\"微信登录已过期\")\n\t\t\t\t\t\tconsole.log('expire');\n\t\t\t\t\t}\t\t\t\n\t\t\t\t})\n\t\t\t})\n\t\t},\t\n\t\t// 判断是否授权（主要是微信小程序）\n\t\tasync getAuthorizeStatus(type, cb, fb) {\n\t\t\tlet _this = this\n\t\t\tif(!type){\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: '请传入scope.type!'\n\t\t\t\t})\n\t\t\t\treturn \n\t\t\t}\n\t\t\tlet scopeText = {\n\t\t\t\t\"scope.userInfo\":\"用户信息\",\n\t\t\t\t\"scope.userLocation\": \"地理位置\",\n\t\t\t\t\"scope.address\": \"通讯地址\",\n\t\t\t\t\"scope.invoiceTitle\": \"发票排头\",\n\t\t\t\t\"scope.invoice\": \"获取发票\",\n\t\t\t\t\"scope.record\": \"录音功能\",\n\t\t\t\t\"scope.werun\": \"微信运动步数\",\n\t\t\t\t\"scope.writePhotosAlbum\": \"保存到相册\",\n\t\t\t\t\"scope.camera\": \"摄像头\"\n\t\t\t}\t\t\n\n\t\t\treturn new Promise((resolve,reject)=>{\n\t\t\t\tgetDeviceApi().getSetting().then((res) => {\n\t\t\t\t\t// debugger\n\t\t\t\t\t// 获取用户授权信息\n\t\t\t\t\tconsole.log(\"打印用户授权的情况集合------------\",res)   // res.userInfo 为true  res.errMsg == \"authorize:ok\"\n\t\t\t\t\tif( res ){\n\t\t\t\t\t\t// debugger\n\t\t\t\t\t\tif(res[1] && res[1]['authSetting'] && res[1]['authSetting'][type]){\n\t\t\t\t\t\t\t// 自动检测到已经授过权\n\t\t\t\t\t\t\tconsole.log(`--------------检测到已授权了：【${scopeText[type]}】 的权限---------`)\n\t\t\t\t\t\t    // 用户已授权 执行回调函数\n\t\t\t\t\t\t    cb && cb();\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tresolve(true)\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\t// 未授权\n\t\t\t\t\t\t\tconsole.log(`----------检测到未授权：【${scopeText[type]}】 的权限-----------`)\n\t\t\t\t\t\t\tfb && fb()\n\t\t\t\t\t\t\tresolve(false)\n\t\t\t\t\t\t}\n\t\t\t\t\t}else {\n\t\t\t\t\t\t// 先判断是否是网络问题造成了请求失败\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tgetDeviceApi().getNetworkType({\n\t\t\t\t\t\t\t\tsuccess: function (res) {\n\t\t\t\t\t\t\t\t\tlet  networkType = res.networkType\n\t\t\t\t\t\t\t\t\tif( networkType != \"none\" ) {\n\t\t\t\t\t\t\t\t\t\t// 有网络，检查 缓存中的授权字段\n\t\t\t\t\t\t\t\t\t\t//   let AuthorizeStatus = _this.getDeviceApi().getStorageSync(\"AuthorizeStatus\");\n\t\t\t\t\t\t\t\t\t\t//   if( AuthorizeStatus ) {\n\t\t\t\t\t\t\t\t\t\t// \tresolve( true ) ;\n\t\t\t\t\t\t\t\t\t\t//   }else {\n\t\t\t\t\t\t\t\t\t\t// \tresolve( false ) ;\n\t\t\t\t\t\t\t\t\t\t//   }  \n\t\t\t\t\t\t\t\t\t\treject(\"--------报错了-------------\")\n\t\t\t\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\t\t\t\t// 无网络 返回true, 弹出 提示\n\t\t\t\t\t\t\t\t\t\t_this.error(\"网络异常\")\n\t\t\t\t\t\t\t\t\t\treject( \"--------网络异常，请先检查网络------------\" ) \n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\treject(\"--------报错了-------\")\n\t\t\t\t\t\t}\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t})\t\t\n\t\t},\t\n\t\t// 授权后登陆 （主要是微信小程序）\t\n\t\t// 授权成功后，进行登陆注册获取 token，并缓存 AuthorizeStatus ,token 等\n\t\tasync authorizeAfter_login(){\n\t\t\t// debugger\n\t\t\t// debugger;\n\t\t\t// 登陆之前，首先将全局的授权状态notAuthrize改为 已授权(true)，并存入 localstorage中，后续判断是否授权都是看localstorage里面的这个字段\n\t\t\treturn new Promise(async (resolve,reject)=>{\n\t\t\t\ttry{\n\t\t\t\t\tconsole.log('---调用login方法---')\n\t\t\t\t\t// let token = that.getDeviceApi().getStorageSync('token') || '';    \n\t\t\t\t\t// let userInfo = that.getDeviceApi().getStorageSync( 'userInfo' ) || '';\n\t\t\t\t\t// if( token )   await that.removeStorage(\"token\" );\n\t\t\t\t\t// if( userInfo )  await that.removeStorage(\"userInfo\" );      \n\t\t\t\t\t// debugger\n\t\t\t\t\t// 先登陆 uni.login();\n\t\t\t\t\t// let {code } = await uni.login();  //通过调用uni.login()获取code 判断是否开始登录\n\t\t\t\t\tlet code_loginRes = ''\n\t\t\t\t\tawait uni.login({\n\t\t\t\t\t\tsuccess: async(res) => {\n\t\t\t\t\t\t\tdebugger\n\t\t\t\t\t\t\tconsole.log(\"-----打印uni.login()登录后返回的code------\",res.code)\n\t\t\t\t\t\t\tcode_loginRes = res.code\n\n\t\t\t\t\t\t\tif(code_loginRes){\n\t\t\t\t\t\t\t\tlet userInfo= await uni.getUserInfo({\n\t\t\t\t\t\t\t\t\tlang: \"zh_CN\"\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tconsole.log(\"-----授权后通过uni.getUserInfo()获取用户信息返回的结果-----：\", userInfo[1])\n\t\t\t\t\t\t\t\tdebugger\n\t\t\t\t\t\t\t\tlet {\n\t\t\t\t\t\t\t\t\tiv,\n\t\t\t\t\t\t\t\t\tencryptedData,\n\t\t\t\t\t\t\t\t\tsignature,\n\t\t\t\t\t\t\t\t\trawData\n\t\t\t\t\t\t\t\t\t} = userInfo[1]\n\n\t\t\t\t\t\t\t\t\t// self.$store.dispatch(\"setUserName\", userInfo[1].userInfo)  // 将返回的数据赋值 存入 store 的app中  \n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tlet params = {\n\t\t\t\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\t\t\t\tcode: code_loginRes,\n\t\t\t\t\t\t\t\t\t\tencryptedData: encryptedData,\n\t\t\t\t\t\t\t\t\t\tiv: iv,\n\t\t\t\t\t\t\t\t\t\ttype: '' //0是扫码，1是点击分享图，2.微信上搜索的\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t//  this.$parent.gloabalData.ret = userInfo;  //  将返回的数据赋值给 全局gloabalData 的ret \n\t\t\t\t\t\t\t\t//   console.log('---获取信息,发送网络请求，将获取到的code 传给后台获取 用户信息（openid、token等信息）---');\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t//   let ret = this.$parent.globalData.ret;\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t//   let type = \"\";\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t//   console.log(\"----打印global中的 optionObj对象信息---：\", this.$parent.globalData.optionObj );\n\t\t\t\t\t\t\t\t//   if ( this.$parent.globalData.optionObj.scene ){\n\t\t\t\t\t\t\t\t// \t// 场景值\n\t\t\t\t\t\t\t\t// \ttype = await self.getEnterType(this.$parent.globalData.optionObj.scene );\n\t\t\t\t\t\t\t\t//   }\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t//   let params = {\n\t\t\t\t\t\t\t\t// \tparams: {\n\t\t\t\t\t\t\t\t// \t  code: code,\n\t\t\t\t\t\t\t\t// \t  encryptedData: ret.encryptedData,\n\t\t\t\t\t\t\t\t// \t  iv: ret.iv,\n\t\t\t\t\t\t\t\t// \t  type: type,       //0是扫码，1是点击分享图，2.微信上搜索的\n\t\t\t\t\t\t\t\t// \t  userId: self.$parent.globalData.optionObj.query.scene ? self.$parent.globalData.optionObj.query.scene : \"\",    // 用户scene唯一标识 用于邀请人数的统计\n\t\t\t\t\t\t\t\t// \t}\n\t\t\t\t\t\t\t\t//   }\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t// 调用 后台注册用户信息的login接口 getOenId 方法\n\t\t\t\t\t\t\t\t// console.log(commApi)\n\t\t\t\t\t\t\t\tcommApi.getOpenId( params, true ).then((res)=>{\n\t\t\t\t\t\t\t\t\t// debugger\n\t\t\t\t\t\t\t\t\tconsole.log(\"------------------\",res)\n\t\t\t\t\t\t\t\t\tif(res && res.statusCode == 200){\n\t\t\t\t\t\t\t\t\t\tlet resData = res.data\n\t\t\t\t\t\t\t\t\t\tif( resData && resData.code == 1){\n\t\t\t\t\t\t\t\t\t\t\t// debugger\n\t\t\t\t\t\t\t\t\t\t\tconsole.log('---网络请求返回成功---')\n\t\t\t\t\t\t\t\t\t\t\tconsole.log(\"-----调取后台login接口注册用户信息成功后获取openid成功------：\", resData)          \n\n\t\t\t\t\t\t\t\t\t\t\t// uni.setStorage( \"token\", resData.data.token )\n\t\t\t\t\t\t\t\t\t\t\t// 将token 存入 store - app中\n\t\t\t\t\t\t\t\t\t\t\tstore.dispatch(\"setUserToken\", resData.data.token)\n\t\t\t\t\t\t\t\t\t\t\t// 将 userInfo 存入 store -app 中\n\t\t\t\t\t\t\t\t\t\t\t// store.dispatch(\"\")\n\t\t\t\t\t\t\t\t\t\t\t// 将userId 存入 store-app 中\n\t\t\t\t\t\t\t\t\t\t\tstore.dispatch(\"setUserId\", resData.data.customer.id)\n\t\t\t\t\t\t\t\t\t\t\t// 缓存 用户信息 userInfo\n\t\t\t\t\t\t\t\t\t\t\t// uni.setStorage( \"userInfo\", JSON.stringify(resData.data.customer) )          \n\t\t\t\t\t\t\t\t\t\t\tresolve(true);  \n\t\t\t\t\t\t\t\t\t\t}else if( resData.code == 1018){\n\t\t\t\t\t\t\t\t\t\t\t// 发现是黑名单用户，跳转至黑名单页面\n\t\t\t\t\t\t\t\t\t\t\t//   this.reLaunchPage(\"../blacklist/index\");\n\t\t\t\t\t\t\t\t\t\t\t//   console.log(\"---------调用后台login接口后返回的状态有问题-------\")\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t\t\tdebugger\n\t\t\t\t\t\t\t\t\t\t\t// 登陆后后台返回错误\n\t\t\t\t\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\t\t\t\t\ttitle: '登陆失败'\n\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\treject(\"-----调用后台login接口后返回的状态有问题-----\")\n\t\t\t\t\t\t\t\t\t\t\tconsole.log(\"---------调用后台login接口后返回的状态有问题-------\")\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}).then(async ()=>{\n\t\t\t\t\t\t\t\t\t// let token = await that.getStorage( \"token\" ) || \"\";\n\t\t\t\t\t\t\t\t\t// let userInfo = await that.getStorage( \"userInfo\" ) || \"\";\n\t\t\t\t\t\t\t\t\t// console.log('--------缓存token成功----------')\n\t\t\t\t\t\t\t\t\t// console.log( \"缓存成功后读取缓存中的token：\", token )\n\t\t\t\t\t\t\t\t\t// console.log('----------缓存userInfo成功--------')\n\t\t\t\t\t\t\t\t\t// console.log( \"缓存成功后读取缓存中的userInfo：\", userInfo ) \n\t\t\t\t\t\t\t\t})\t\t\t\t\t\t\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\treject(\"---登陆微信后台 wx.login() 接口返回异常---\");\n\t\t\t\t\t\t\t\tconsole.log('---登陆微信后台 wx.login() 接口返回异常---')\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tfail: (error) => {\n\t\t\t\t\t\t\tdebugger\n\t\t\t\t\t\t\tconsole.log(\"-----打印登录后------\", error)\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}catch (error) {\n\t\t\t\t\tconsole.log(error)\n\t\t\t\t\treject(error)\n\t\t\t\t}\n\t\t\t}) \n\t\t},\n\t\t// app 检测localStorage 中是否有userToken\n\t\tappCheckLocalStorageToken() {\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tlet res_localStorage = uni.getStorageSync(\"userToken\")\n\t\t\t\tif(res_localStorage){\n\t\t\t\t\tstore.dispatch(\"setUserToken\", res_localStorage)\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t}\n}\n"],"sourceRoot":""}