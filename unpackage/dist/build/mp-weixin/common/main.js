(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["common/main"],{"57e2":function(e,t,n){},"749a":function(e,t,n){"use strict";n.r(t);var o=n("f7ef");for(var c in o)"default"!==c&&function(e){n.d(t,e,function(){return o[e]})}(c);n("612e"),n("a6a5"),n("8e70"),n("f18b");var a,i,r=n("2877"),s=Object(r["a"])(o["default"],a,i,!1,null,null,null);t["default"]=s.exports},"8e56":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n("a34a")),c=(r(n("66fd")),r(n("fd4d"))),a=(r(n("e15a")),n("518d")),i=r(n("04cd"));function r(e){return e&&e.__esModule?e:{default:e}}function s(e,t,n,o,c,a,i){try{var r=e[a](i),s=r.value}catch(u){return void n(u)}r.done?t(s):Promise.resolve(s).then(o,c)}function u(e){return function(){var t=this,n=arguments;return new Promise(function(o,c){var a=e.apply(t,n);function i(e){s(a,o,c,i,r,"next",e)}function r(e){s(a,o,c,i,r,"throw",e)}i(void 0)})}}var l={onLaunch:function(){var e=u(o.default.mark(function e(){var t,n=this;return o.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this,console.log("App Launch"),this.checkNewVersion(),this.chekWeixinLogin().then(function(e){console.log("---打印检查微信是否登录返回的res---------",e),e?console.log("微信是登录状态"):console.log("微信没有登录")}),e.next=6,this.getAuthorizeStatus("scope.userInfo",u(o.default.mark(function e(){return o.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:console.log("App------onLaunch------检测到用户信息已授权-true----"),c.default.dispatch("setAuthorizeState",{authorizeState:!0}),n.authorizeAfter_login().then(function(){console.log("APP onLaunch 登陆成功")});case 3:case"end":return e.stop()}},e,this)})),u(o.default.mark(function e(){return o.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:console.log("App------onLaunch------检测到用户信息未授权--false---"),c.default.dispatch("setAuthorizeState",{authorizeState:!1});case 2:case"end":return e.stop()}},e,this)})));case 6:t=e.sent,console.log("---------APP初始化时，onlanch中打印 是否授权--------",t);case 8:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),onShow:function(){console.log("App Show")},onHide:function(){console.log("App Hide")},methods:{getAppCid:function(){var t=this,n=plus.push.getClientInfo().clientid;console.log("获取到的应用clientid",n),n?e.setStorage({key:"clientid",data:n,success:function(){console.log("clientid 存储success")}}):setTimeout(function(){n=plus.push.getClientInfo().clientid,console.log("setTimeOut后打印的clientid",n)},4e3),plus.push.addEventListener("click",function(e){t.pushCallBack("click事件",e)}),plus.push.addEventListener("receive",function(e){t.pushCallBack("reciive事件",e)})},pushCallBack:function(t,n){e.showToast({title:"".concat(t,",消息内容：").concat(n)})},checkNewVersion:function(){if(console.log("-------检查小程序是否有新版本-------checkNewVersion----------"),e.canIUse("getUpdateManager")){var t=e.getUpdateManager();t.onCheckForUpdate(function(e){console.log("---检查小程序是否有新版本---",e.hasUpdate)}),t.onUpdateReady(function(){e.showModal({title:"更新提示",content:"新版本已经准备好，是否重启应用？",success:function(e){if(e.confirm)t.applyUpdate();else if(e.cancel)return!1}})}),t.onUpdateFailed(function(){e.hideLoading(),e.showModal({title:"升级失败",content:"新版本下载失败，请检查网络！",showCancel:!1})})}},chekWeixinLogin:function(){return new Promise(function(e,t){(0,a.getDeviceApi)().checkSession({success:function(){console.log("微信登录session_key未过期，ok"),e(!0)},fail:function(){t("微信登录已过期"),console.log("expire")}})})},getAuthorizeStatus:function(){var t=u(o.default.mark(function t(n,c,i){var r,s;return o.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(r=this,n){t.next=4;break}return e.showToast({title:"请传入scope.type!"}),t.abrupt("return");case 4:return s={"scope.userInfo":"用户信息","scope.userLocation":"地理位置","scope.address":"通讯地址","scope.invoiceTitle":"发票排头","scope.invoice":"获取发票","scope.record":"录音功能","scope.werun":"微信运动步数","scope.writePhotosAlbum":"保存到相册","scope.camera":"摄像头"},t.abrupt("return",new Promise(function(e,t){(0,a.getDeviceApi)().getSetting().then(function(o){if(console.log("打印用户授权的情况集合------------",o),o)o[1]&&o[1]["authSetting"]&&o[1]["authSetting"][n]?(console.log("--------------检测到已授权了：【".concat(s[n],"】 的权限---------")),c&&c(),e(!0)):(console.log("----------检测到未授权：【".concat(s[n],"】 的权限-----------")),i&&i(),e(!1));else try{(0,a.getDeviceApi)().getNetworkType({success:function(e){var n=e.networkType;"none"!=n?t("--------报错了-------------"):(r.error("网络异常"),t("--------网络异常，请先检查网络------------"))}})}catch(u){t("--------报错了-------")}})}));case 6:case"end":return t.stop()}},t,this)}));function n(e,n,o){return t.apply(this,arguments)}return n}(),authorizeAfter_login:function(){var t=u(o.default.mark(function t(){return o.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(){var t=u(o.default.mark(function t(n,a){var r;return o.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,console.log("---调用login方法---"),r="",t.next=5,e.login({success:function(){var t=u(o.default.mark(function t(s){var l,f,p,d,h;return o.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(console.log("-----打印uni.login()登录后返回的code------",s.code),r=s.code,!r){t.next=14;break}return t.next=6,e.getUserInfo({lang:"zh_CN"});case 6:l=t.sent,console.log("-----授权后通过uni.getUserInfo()获取用户信息返回的结果-----：",l[1]),f=l[1],p=f.iv,d=f.encryptedData,f.signature,f.rawData,h={params:{code:r,encryptedData:d,iv:p,type:""}},i.default.getOpenId(h,!0).then(function(t){if(console.log("------------------",t),t&&200==t.statusCode){var o=t.data;o&&1==o.code?(console.log("---网络请求返回成功---"),console.log("-----调取后台login接口注册用户信息成功后获取openid成功------：",o),e.setStorageSync("userToken",o.data.token),e.setStorageSync("customer",JSON.stringify(o.data.customer)),c.default.dispatch("setUserToken",o.data.token),c.default.dispatch("setUserId",o.data.customer.id),n(!0)):1018==o.code||(e.showToast({title:"登陆失败"}),a("-----调用后台login接口后返回的状态有问题-----"),console.log("---------调用后台login接口后返回的状态有问题-------"))}}).then(u(o.default.mark(function e(){return o.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}))),t.next=16;break;case 14:a("---登陆微信后台 wx.login() 接口返回异常---"),console.log("---登陆微信后台 wx.login() 接口返回异常---");case 16:case"end":return t.stop()}},t,this)}));function s(e){return t.apply(this,arguments)}return s}(),fail:function(e){console.log("-----打印登录后------",e)}});case 5:t.next=11;break;case 7:t.prev=7,t.t0=t["catch"](0),console.log(t.t0),a(t.t0);case 11:case"end":return t.stop()}},t,this,[[0,7]])}));return function(e,n){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}},t,this)}));function n(){return t.apply(this,arguments)}return n}(),appCheckLocalStorageToken:function(){return new Promise(function(t,n){var o=e.getStorageSync("userToken");o&&c.default.dispatch("setUserToken",o)})}}};t.default=l}).call(this,n("543d")["default"])},f18b:function(e,t,n){"use strict";var o=n("57e2"),c=n.n(o);c.a},f7ef:function(e,t,n){"use strict";n.r(t);var o=n("8e56"),c=n.n(o);for(var a in o)"default"!==a&&function(e){n.d(t,e,function(){return o[e]})}(a);t["default"]=c.a}},[["1e69","common/runtime","common/vendor"]]]);